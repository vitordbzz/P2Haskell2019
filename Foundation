instance Yesod App where
    makeLogger = return . appLogger
    authRoute _ = Just $ LoginR
    
    isAuthorized LoginR _ = return Authorized
    isAuthorized HomeR  _ = return Authorized
    isAuthorized UsuarioR _ = return Authorized
    isAuthorized (StaticR _) _ = return Authorized
    isAuthorized AdminR _ = isAdmin
    isAuthorized _ _ = isUser

isAdmin :: Handler AuthResult
isAdmin = do 
    sess <- lookupSession "_ID"
    case sess of 
        Just "root" -> return Authorized
        Just _ -> return $ Unauthorized "N eh admin!"
        Nothing -> return AuthenticationRequired

isUser :: Handler AuthResult
isUser = do 
    sess <- lookupSession "_ID"
    case sess of 
        Just _ -> return Authorized
        Nothing -> return AuthenticationRequired